DOCKER_COMPOSE  = $(shell which docker-compose)
ifeq ($(DOCKER_COMPOSE),)
COMPOSE=docker compose
else
COMPOSE=docker-compose
endif


DOCKER_OPTIONS=run ydfs2.12 bash
BUILD_COMMAND=cp -a /2.12/ /tmp;cd /tmp/2.12;

OPTION_BUILD=DIBAB_VERBOSE_BUILD=YES BUILDME=OK
OPTION_BUILD=DIBAB_VERBOSE_BUILD=YES
OPTION_BUILD=

bash-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} bash'

opkg-docker:
	chmod 777 ${HOME}/.ncftp/bookmarks
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} DISTRONAME=all BUILDOPKG=YES make opkg'
	ls -l  ${HOME}/2.12-modules/ydfs/opkg/
	chmod 700 ${HOME}/.ncftp/bookmarks

buildenv-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make buildenv'

mate-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make mate'

kodi-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make kodi'

kde-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make kde'

iso-verbose-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} DIBAB_VERBOSE_BUILD="YES"  make iso'

virtualbox-docker:
	#docker compose run -t -i ydfs2.12-modules-fast64 bash -c '${BUILD_COMMAND} ${OPTION_BUILD}BUILDME=OK make virtualbox'
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make virtualbox'

iso-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make iso'

updates-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make updates'

live-test-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make live-test'

devtools-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make devtools'

openxr-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make openxr'

iso-devtools-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} DISTRONAME=devtools make iso'

