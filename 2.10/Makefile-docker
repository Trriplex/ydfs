DOCKER_COMPOSE  = $(shell which docker-compose)
ifeq ($(DOCKER_COMPOSE),)
COMPOSE=docker compose
else
COMPOSE=docker-compose
endif

DOCKER_OPTIONS=run --rm --remove-orphans ydfs2.10-modules-fast64 bash 
DOCKER_OPTIONS=run --remove-orphans ydfs2.10-modules-fast64 bash
BUILD_COMMAND=cp -a /2.10/ /tmp;cd /tmp/2.10;

OPTION_BUILD=
OPTION_BUILD=DIBAB_VERBOSE_BUILD=YES BUILDME=OK
OPTION_BUILD=DIBAB_VERBOSE_BUILD=YES

bash-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} bash'

opkg-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} DISTRONAME=all BUILDOPKG=YES make opkg'
	ls -l  ${HOME}/2.10-modules/ydfs/opkg/

buildenv-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make buildenv'

mate-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make mate'

kodi-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make kodi'

kde-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make kde'

iso-verbose-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} DIBAB_VERBOSE_BUILD="YES"  make iso'

virtualbox-docker:
	#docker compose run -t -i ydfs2.10-modules-fast64 bash -c '${BUILD_COMMAND} ${OPTION_BUILD}BUILDME=OK make virtualbox'
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make virtualbox'

iso-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make iso'

updates-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make updates'

live-test-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make live-test'

devtools-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make devtools'

erp-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} make erp'

iso-devtools-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c '${BUILD_COMMAND} ${OPTION_BUILD} DISTRONAME=devtools make iso'

