DOCKER_COMPOSE  = $(shell which docker-compose)
ifeq ($(DOCKER_COMPOSE),)
COMPOSE=docker compose
else
COMPOSE=docker-compose
endif

DOCKER_OPTIONS=run --rm --remove-orphans ydfs2.10-modules-fast64 bash
DOCKER_OPTIONS=run ydfs2.10-modules-fast64 bash

bash-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c 'cp -a /2.10/ /tmp;cd /tmp/2.10; bash'

opkg-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c 'cp -a /2.10/ /tmp;cd /tmp/2.10; DISTRONAME=all BUILDOPKG=YES make opkg'

buildenv-docker:
       ${COMPOSE} ${DOCKER_OPTIONS} -c 'cp -a /2.10/ /tmp;cd /tmp/2.10; make buildenv'

mate-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c 'cp -a /2.10/ /tmp;cd /tmp/2.10; make mate'

kde-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c 'cp -a /2.10/ /tmp;cd /tmp/2.10; make kde'

iso-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c 'cp -a /2.10/ /tmp;cd /tmp/2.10; make iso'

iso-verbose-docker:
	${COMPOSE} ${DOCKER_OPTIONS} -c 'cp -a /2.10/ /tmp;cd /tmp/2.10; DIBAB_VERBOSE_BUILD="YES"  make iso'

virtualbox-docker:
	#docker compose run -t -i ydfs2.10-modules-fast64 bash -c 'cp -a /2.10/ /tmp;cd /tmp/2.10;BUILDME=OK make virtualbox'
	${COMPOSE} ${DOCKER_OPTIONS} -c 'cp -a /2.10/ /tmp;cd /tmp/2.10;make virtualbox'
